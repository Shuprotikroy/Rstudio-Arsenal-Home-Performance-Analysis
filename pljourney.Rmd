---
title: "PlJourney"
output: html_document
date: "2022-09-21"
author: "Shuprotik Roy"
---

## loading pldataset
```{r pldataset}
pldataset <- read.csv("C:\\Users\\hp\\Downloads\\plneededdataset.csv", header=TRUE)
head(pldataset[,1:8],10)

```

## filtering pldataset, removing unneeded data
```{r filteredpldataset}
filteredpldataset = pldataset[,c(2:24)]
head(filteredpldataset[,1:8],10)
```

## sort date in an unified format 
```{r datasort}

filteredpldataset$Date <- as.Date(filteredpldataset$Date, '%d/%m/%Y')
head(filteredpldataset[,1:8],10)
```
## wanted to perform a monthwise analysis, so I sorted the data monthwise(for eg:August)
```{r sort}
augustpldataset <- subset(filteredpldataset, format(filteredpldataset$Date, '%m') == "08")
head(augustpldataset[,1:8],10)
```

#Aggregate Data
```{r aggregate}
aggregate(FTHG ~ HomeTeam, augustpldataset, sum)
```
#fill custom color scheme
```{r colorscheme}
ggplot(data = aggregated_homegames, aes(x = FTHG, y = HomeTeam, fill = HomeTeam)) + geom_bar(stat="identity") + geom_text(aes(label = FTHG))+scale_fill_manual(values = c("orangered1", "goldenrod1","firebrick4","gray0","azure","brown1","chartreuse4","gray30","red2","darkturquoise","darkred","blue4","cornflowerblue","darkblue","cyan4","dodgerblue3","firebrick","deepskyblue3","tomato1","yellow1"))0
```


# aggregating data
```{}
aggregated_homegames<- aggregate(cbind(FTHG,FTAG)~ HomeTeam, augustpldataset, sum)

```
# aggregate graph 1
```{r plot}
 ggplot(data = aggregated_homegames, aes(x = FTHG, y = reorder(HomeTeam, +FTHG), color = as.factor(FTHG), )) + geom_bar(stat="identity",width=0.70,fill = "black" ) + geom_text(aes(label = FTHG, hjust =2,fontface = "bold", family = "mono")) + labs(title = "Teams with most home games",x = "Full Time Home Goals", y="Teams") + theme_classic()+ theme_dark()  + theme( text = element_text(family = "mono", face = "bold"),panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.title  = element_text(size = 10),axis.text = element_text(size=8)) + scale_colour_brewer(palette = "Set3")
 ``